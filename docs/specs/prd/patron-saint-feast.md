# PRD: 세례명 축일자 명단 + 통계 총계

> SDD 작성자가 작성하는 제품 요구사항 문서입니다.
> 사업 에이전트의 `docs/business/` 문서를 기반으로 작성합니다.

## 배경/문제 요약

- 참고: `docs/business/6_roadmap/roadmap.md` (2단계 — 유저 확장 + 가톨릭 특화)
- 참고: `docs/business/STATUS.md` ("출석 + 가톨릭 정보가 한곳에 있는 주간 허브")
- 문제 1: 교리교사가 이달에 축일이 있는 멤버를 파악하려면 명단을 일일이 확인해야 함. 축일 축하/선물 준비 등 행정 부담이 있음
- 문제 2: 대시보드의 전체 출석률/평균 출석 인원 차트와 그룹별 TOP 5가 실제로 잘 활용되지 않음. 그룹별 상세 통계 테이블이 더 유용하지만 전체 합산(총계)이 없어 한눈에 파악이 어려움
- 현재 상태: Student 테이블에 `catholicName`(세례명)과 `baptizedAt`(축일, MM/DD 형식) 필드가 이미 존재. 대시보드에 출석률 차트 2개 + TOP 5 카드 2개 + 그룹별 통계 테이블 구성
- 목표 상태: 이달의 축일자 목록 자동 표시 + 그룹별 통계 테이블에 총계 행 추가

## 목표/성공 기준

- **목표**: 가톨릭 정보 허브 가치 강화 (축일자 자동 표시) + 대시보드 실용성 개선 (총계 행)
- **성공 지표**: 축일자 카드 노출률 (GA4 `patron_feast_card_viewed`), 대시보드 체류 시간
- **측정 기간**: 출시 후 4주

## 사용자/대상

- **주요 사용자**: 교리교사 (주일학교 운영자)
- **사용 맥락**: 매주 일요일 대시보드 진입 시 이달의 축일자 확인, 전체 출석 현황 파악

## 범위

### 포함

- 이달의 축일자 목록 (대시보드 카드)
- 그룹별 통계 테이블 총계 행

### 제외

- 성인 축일 DB (대규모 성인 데이터베이스 구축)
- 세례명 입력 시 자동완성/축일 자동 매핑
- 축일 알림/푸시
- 기존 출석률 차트/TOP 카드 제거 (유지)

## 사용자 시나리오

1. **이달의 축일자 확인**: 교리교사가 대시보드에 진입하면 이달에 축일이 있는 멤버 목록을 카드로 확인. "이번 달 베드로(6/29)가 축일이구나, 축하해줘야지" → 별도 검색/수기 확인 없이 바로 파악
2. **전체 출석 현황 파악**: 교리교사가 그룹별 통계 테이블 하단의 총계 행에서 전체 인원, 전체 출석률, 전체 평균 출석 인원을 한눈에 확인

## 요구사항

### 필수 (Must)

- [ ] 대시보드에 "이달의 축일자" 카드 표시
- [ ] 현재 월 기준, `baptizedAt` 필드의 월이 일치하는 멤버 목록 조회
- [ ] 축일자 카드: 멤버 이름, 세례명, 축일 날짜 표시
- [ ] 축일자가 없으면 카드 미표시 또는 "이달의 축일자가 없습니다" 표시
- [ ] 그룹별 통계 테이블 마지막 행에 총계(전체) 행 추가
- [ ] 총계 행: 전체 인원, 전체 주간/월간/연간 출석률, 전체 주간/월간/연간 평균 출석 인원

### 선택 (Should)

- [ ] 축일자 카드에 날짜순 정렬 (이달 내 가까운 축일 먼저)
- [ ] GA4 이벤트: 축일자 카드 노출 시 `patron_feast_card_viewed`

### 제외 (Out)

- 성인 축일 자동완성 (catholicName → baptizedAt 자동 매핑)
- 축일 알림 기능
- 대시보드 기존 차트/TOP 카드 제거 (별도 의사결정 필요)

## 제약/가정/리스크

- **제약**: `baptizedAt` 필드가 `varchar(10)` 타입으로 "MM/DD" 형식 문자열. DB 스키마 변경 없이 문자열 비교로 필터링
- **가정**: 기존 데이터의 `baptizedAt`이 "MM/DD" 형식으로 일관되게 입력되어 있음
- **리스크**: `baptizedAt`이 비어있거나 형식이 다른 데이터가 존재할 수 있음 → 형식 불일치 시 해당 멤버 제외

## 의존성

- **내부**: 기존 Student 테이블 (`catholicName`, `baptizedAt` 필드), 기존 `statistics.weekly/monthly/yearly` API 결과
- **외부**: 없음

## 롤아웃/검증

- **출시 단계**: 전체 사용자 동시 적용
- **이벤트/로그**: `patron_feast_card_viewed` (축일자 카드 노출)
- **검증 방법**: GA4 이벤트 발생 확인, 대시보드 체류 시간 변화 관찰

## 오픈 이슈

- [ ] `baptizedAt` 데이터 형식 일관성 확인 필요 (기존 데이터 검증)

## 연결 문서

- 사업 문서: `docs/business/6_roadmap/roadmap.md` (2단계)
- 기능 설계 (학생): `docs/specs/functional-design/student-management.md`
- 기능 설계 (통계): `docs/specs/functional-design/statistics.md`

---

**작성일**: 2026-02-18
**작성자**: SDD 작성자
**상태**: Approved (구현 완료)