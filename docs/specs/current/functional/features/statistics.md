# Feature: 통계

> 이 문서는 기능의 **단일 정보원(Single Source of Truth)** 입니다.
> 기술적 구현 방법이 아닌 **"무엇을"** 만들지에 집중합니다.

## 상위 문서

- PRD: `docs/specs/prd/school-attendance.md` (로드맵 1단계 섹션)
- 기능 설계: `docs/specs/functional-design/statistics.md` (우수 출석 + 대시보드 통계 포함)

## 개요

대시보드에 출석 통계 카드를 추가하여, 사용자가 로그인 후 바로 주요 현황을 파악할 수 있게 한다.

## 배경

- **현재 문제점**: 로그인 후 대시보드가 메뉴 바로가기만 제공하며, 출석 현황 파악을 위해 별도 페이지로 이동해야 함
- **목표 상태**: 대시보드에서 주간/월간 출석률, 우수 학생 등 핵심 통계를 한눈에 확인
- **사업 연계**: 로드맵 1단계 "통계 개선" - 사용자 초기 가치 체감 향상

## 사용자 스토리

### US-1: 주간/월간/연간 출석률 확인

- **사용자**: 주일학교 교사
- **원하는 것**: 로그인 후 대시보드에서 이번 주/이번 달/올해 출석률을 확인하고 싶다
- **이유**: 전체 현황을 빠르게 파악하여 출석 관리에 참고하기 위해

### US-2: 주간/월간/연간 평균 출석 인원 확인

- **사용자**: 주일학교 교사
- **원하는 것**: 주간/월간/연간 평균 출석 인원을 확인하고 싶다
- **이유**: 출석 추세를 숫자로 직관적으로 파악하기 위해

### US-3: 성별 출석 분포 확인

- **사용자**: 주일학교 교사
- **원하는 것**: 남/여 학생의 출석 비율을 확인하고 싶다
- **이유**: 성별 간 출석 차이를 파악하여 관리에 활용하기 위해

### US-4: 그룹별 출석률 순위 확인

- **사용자**: 주일학교 교사
- **원하는 것**: 어느 그룹이 출석률이 높은지 순위를 확인하고 싶다
- **이유**: 그룹 간 비교를 통해 출석 장려에 활용하기 위해

### US-5: 우수 출석 학생 확인

- **사용자**: 주일학교 교사
- **원하는 것**: 출석을 잘하는 학생 TOP 5를 확인하고 싶다
- **이유**: 우수 출석 학생을 칭찬하고 동기부여하기 위해

### US-6: 그룹별 우수 학생 확인

- **사용자**: 주일학교 교사
- **원하는 것**: 각 그룹마다 우수 출석 학생 TOP 5를 확인하고 싶다
- **이유**: 그룹별로 칭찬할 학생을 파악하기 위해

## 기능 요구사항

### 필수 (Must Have)

- [x] **FR-1**: 대시보드에 주간 출석률 차트 표시 (%)
- [x] **FR-2**: 대시보드에 월간 출석률 차트 표시 (%)
- [x] **FR-3**: 대시보드에 연간 출석률 차트 표시 (%)
- [x] **FR-4**: 대시보드에 주간 평균 출석 인원 표시
- [x] **FR-5**: 대시보드에 월간 평균 출석 인원 표시
- [x] **FR-6**: 대시보드에 연간 평균 출석 인원 표시
- [x] **FR-7**: 대시보드에 성별 출석 분포 도넛 차트 표시 (남/여/미지정)
- [x] **FR-8**: 대시보드에 그룹별 출석률 순위 TOP 5 표시
- [x] **FR-9**: 대시보드에 그룹별 우수 학생 TOP 5 표시
- [x] **FR-10**: 대시보드에 전체 우수 출석 학생 TOP 5 표시
- [x] **FR-11**: Student 테이블에 gender 필드 추가 (M/F/null)
- [x] **FR-12**: 그룹별 상세 통계 테이블 (주간/월간/연간 출석률 + 평균 인원)
- [x] **FR-13**: 그래프/차트 시각화 (Recharts - 막대 차트, 도넛 차트)
- [x] **FR-14**: 기존 통계 페이지 삭제 및 대시보드 통합

### 선택 (Nice to Have)

- [ ] **FR-15**: 통계 데이터 캐싱 (1분 TTL)

## 엣지 케이스

| 케이스 | 예상 동작 |
|--------|----------|
| 출석 데이터 없음 | 0% 또는 "데이터 없음" 표시 |
| 학생이 없는 그룹 | 해당 그룹 제외 |
| 성별 미지정 학생 | "미지정" 카테고리로 집계 |
| year 파라미터 누락 | 현재 연도로 대체 |
| 토큰 누락 | 401 UNAUTHORIZED 반환 |
| 모든 학생 성별 미지정 | 미지정 100%로 표시 |

## 인수 조건 (Acceptance Criteria)

- [x] **AC-1**: 대시보드 진입 시 모든 통계 차트/카드가 로드된다
- [x] **AC-2**: 주간 출석률이 퍼센트(%)로 차트에 표시된다
- [x] **AC-3**: 월간 출석률이 퍼센트(%)로 차트에 표시된다
- [x] **AC-4**: 연간 출석률이 퍼센트(%)로 차트에 표시된다
- [x] **AC-5**: 주간/월간/연간 평균 출석 인원이 차트로 표시된다
- [x] **AC-6**: 성별 분포가 남/여/미지정으로 도넛 차트에 표시된다
- [x] **AC-7**: 그룹별 출석률 TOP 5가 순위대로 표시된다
- [x] **AC-8**: 전체 우수 출석 학생 TOP 5가 표시된다
- [x] **AC-9**: 그룹별 상세 통계 테이블이 표시된다
- [x] **AC-10**: 데이터 로딩 중 스피너가 표시된다
- [x] **AC-11**: 데이터 오류 시 적절한 안내 메시지가 표시된다
- [x] **AC-12**: 연도 선택 시 해당 연도 데이터로 갱신된다

## 관련 문서

- Task: `docs/specs/current/functional/tasks/statistics.md`
- Development: `docs/specs/current/functional/development/statistics.md`

---

**작성일**: 2026-01-22
**최종 수정**: 2026-01-22
**상태**: Approved