# Feature: 학생 관리

> 이 문서는 기능의 **단일 정보원(Single Source of Truth)** 입니다.
> 기술적 구현 방법이 아닌 **"무엇을"** 만들지에 집중합니다.

## 상위 문서

- PRD: `docs/specs/prd/school-attendance.md`
- 기능 설계: `docs/specs/functional-design/student-management.md` (기본 + 일괄 삭제/복구 + 졸업 처리 + 엑셀 Import 포함)

## 개요

계정은 학생 정보를 조회/검색/추가/수정/삭제하고, 졸업(진급) 처리를 수행한다.

## 배경

- 학생 정보를 지속적으로 관리해야 한다.
- 학년 진급/졸업 처리를 정기적으로 수행해야 한다.

## 사용자 스토리

### US-1: 학생을 검색하고 목록을 본다
- **사용자**: 교사/관리자
- **원하는 것**: 학생 목록을 페이지로 조회하고 조건으로 검색하기
- **이유**: 많은 학생 정보를 빠르게 찾기 위해

### US-2: 학생 정보를 관리한다
- **사용자**: 교사/관리자
- **원하는 것**: 학생 정보를 추가/수정/삭제하기
- **이유**: 실제 학생 데이터와 시스템을 일치시키기 위해

### US-3: 졸업/진급을 처리한다
- **사용자**: 특정 계정(초등부/중고등부)
- **원하는 것**: 규칙에 따라 학생의 그룹을 일괄 이동시키기
- **이유**: 학년 전환을 자동화하기 위해

### US-4: 학생 상세 정보를 빠르게 수정한다 (로드맵 1단계)
- **사용자**: 교사/관리자
- **원하는 것**: 학생 상세 페이지에서 필드를 인라인으로 수정하기
- **이유**: 별도 수정 폼 없이 빠르게 정보를 갱신하기 위해

### US-5: 여러 학생을 한 번에 삭제한다 (로드맵 1단계)
- **사용자**: 교사/관리자
- **원하는 것**: 학생 목록에서 여러 학생을 선택하여 일괄 삭제하기
- **이유**: 학기 전환, 졸업 등 대량 정리 작업을 효율적으로 하기 위해

### US-6: 삭제된 학생을 복구한다 (로드맵 1단계)
- **사용자**: 교사/관리자
- **원하는 것**: 삭제된 학생 필터에서 학생을 선택하여 복구하기
- **이유**: 실수로 삭제한 학생의 출석 기록을 보존하면서 복구하기 위해

### US-7: 삭제된 학생을 필터링하여 본다 (로드맵 1단계)
- **사용자**: 교사/관리자
- **원하는 것**: 삭제 필터로 재학생/삭제된 학생을 구분하여 조회하기
- **이유**: 삭제된 학생도 관리하고 필요시 복구하기 위해

### US-8: 여러 학생을 한 번에 졸업 처리한다 (로드맵 1단계)
- **사용자**: 교사/관리자
- **원하는 것**: 학생 목록에서 여러 학생을 선택하여 일괄 졸업 처리하기
- **이유**: 학기 말 졸업 작업을 효율적으로 처리하기 위해

### US-9: 졸업생을 조회한다 (로드맵 1단계)
- **사용자**: 교사/관리자
- **원하는 것**: 졸업생 필터로 졸업한 학생 목록을 조회하기
- **이유**: 졸업생의 출석 기록을 확인하거나 관리하기 위해

### US-10: 졸업을 취소한다 (로드맵 1단계)
- **사용자**: 교사/관리자
- **원하는 것**: 잘못 졸업 처리된 학생의 졸업을 취소하기
- **이유**: 실수로 졸업 처리된 학생을 재학 상태로 복구하기 위해

### US-11: 재학생/졸업생/전체를 구분하여 조회한다 (로드맵 1단계)
- **사용자**: 교사/관리자
- **원하는 것**: 필터로 재학생만, 졸업생만, 전체를 선택하여 조회하기
- **이유**: 필요에 따라 학생 목록을 구분하여 관리하기 위해

## 기능 요구사항

### 필수 (Must Have)
- [x] 계정이 관리하는 학생 목록을 조회할 수 있어야 한다.
- [x] 학생 목록은 페이지네이션을 제공해야 한다.
- [x] 학생 목록은 특정 필드로 검색할 수 있어야 한다.
- [x] 학생 상세 정보를 조회할 수 있어야 한다.
- [x] 학생 정보를 추가/수정/삭제할 수 있어야 한다.
- [x] 졸업/진급 처리를 실행할 수 있어야 한다.

### 필수 - 로드맵 1단계 (Must Have)
- [ ] 학생 목록에서 학생 클릭 시 상세 페이지로 이동해야 한다.
- [ ] 학생 상세 페이지에서 필드를 인라인으로 수정할 수 있어야 한다.
- [ ] 인라인 수정 시 포커스 아웃으로 자동 저장되어야 한다.
- [ ] 학생 목록에서 삭제 필터(재학생/삭제된 학생)를 제공해야 한다.
- [ ] 학생 목록에서 다중 선택 체크박스를 제공해야 한다.
- [ ] 선택한 학생을 일괄 삭제할 수 있어야 한다 (student.bulkDelete API).
- [ ] 삭제된 학생 필터에서 학생을 복구할 수 있어야 한다 (student.restore API).
- [ ] 테이블 UI에 호버 효과, 선택 상태 하이라이트가 있어야 한다.
- [ ] 삭제 시 확인 다이얼로그를 표시해야 한다.
- [ ] 작업 완료 시 토스트 메시지로 피드백을 제공해야 한다.

### 필수 - 졸업 처리 (로드맵 1단계)
- [ ] 학생 목록에서 다중 선택 체크박스를 제공해야 한다.
- [ ] 선택한 학생을 일괄 졸업 처리할 수 있어야 한다 (`student.graduate` API).
- [ ] 졸업 처리 시 확인 모달을 표시해야 한다.
- [ ] 졸업 처리된 학생은 기본 목록(재학생)에서 숨겨져야 한다.
- [ ] 학생 목록에 졸업 필터(재학생/졸업생/전체)를 제공해야 한다.
- [ ] 졸업생 필터 선택 시 졸업생 목록이 표시되어야 한다.
- [ ] 졸업생의 졸업을 취소할 수 있어야 한다 (`student.cancelGraduation` API).
- [ ] 졸업 처리/취소 시 데이터(출석 기록 포함)가 보존되어야 한다.
- [ ] 졸업생에게 "졸업" 배지가 표시되어야 한다.

### 필수 - Breaking Change (로드맵 1단계)
- [ ] 기존 `student.graduate` (그룹 이동/진급)를 `student.promote`로 이름 변경해야 한다.

### 선택 (Nice to Have)
- [x] 없음 (현재 스코프)

## 엣지 케이스

| 케이스                 | 예상 동작                 |
|---------------------|-----------------------|
| 잘못된 studentId       | BAD_REQUEST 코드로 실패 응답 |
| 토큰 누락               | 인증 실패 응답              |
| 검색 옵션이 없거나 알 수 없는 값 | 전체 목록 반환              |
| 검색어가 비어 있음          | 해당 필터 무시              |
| 필수 필드 누락            | 실패 응답                 |
| 졸업/진급 대상이 없음        | row=0 반환              |
| 일괄 삭제 시 빈 배열 (로드맵 1단계) | BAD_REQUEST 코드로 실패 응답 |
| 일괄 삭제 시 일부 학생 없음 (로드맵 1단계) | 존재하는 학생만 삭제, deletedCount 반환 |
| 이미 삭제된 학생 재삭제 (로드맵 1단계) | UI에서 보이지 않음 (불가능) |
| 복구 시 빈 배열 (로드맵 1단계) | BAD_REQUEST 코드로 실패 응답 |
| 인라인 수정 시 필수 필드 누락 (로드맵 1단계) | BAD_REQUEST 코드로 실패 응답 |
| 선택 없이 졸업 처리 버튼 클릭 (로드맵 1단계) | 버튼 비활성화 |
| 이미 졸업한 학생 재졸업 시도 (로드맵 1단계) | 무시 (처리 수에서 제외) |
| 재학생 졸업 취소 시도 (로드맵 1단계) | 무시 (처리 수에서 제외) |
| 졸업 처리 빈 studentIds 배열 (로드맵 1단계) | 400 BAD_REQUEST 에러 |
| 졸업 처리 100명 초과 요청 (로드맵 1단계) | 400 BAD_REQUEST 에러 |

## 인수 조건 (Acceptance Criteria)

- [x] 목록 조회 시 `page`, `size`, `totalPage`, `students`가 반환된다.
- [x] 학생 추가/수정/삭제 시 학생 정보가 반환된다.
- [x] 잘못된 학생 ID는 BAD_REQUEST로 실패한다.
- [x] 졸업/진급 실행 시 처리된 행 수가 반환된다.

### 인수 조건 - 로드맵 1단계
- [ ] 학생 목록 행 클릭 시 `/students/:id` 상세 페이지로 이동한다.
- [ ] 학생 상세 페이지에서 필드 클릭 시 인라인 편집 모드로 전환된다.
- [ ] 인라인 편집 후 포커스 아웃 시 자동으로 API가 호출되어 저장된다.
- [ ] 삭제 필터 변경 시 해당 조건의 학생 목록이 조회된다.
- [ ] 학생 목록에 전체 선택/개별 선택 체크박스가 표시된다.
- [ ] 선택된 학생이 있을 때만 삭제 버튼이 활성화된다.
- [ ] 삭제된 학생 필터에서는 삭제 버튼 대신 복구 버튼이 표시된다.
- [ ] 일괄 삭제 클릭 시 확인 다이얼로그가 표시되고, 선택된 학생 목록이 보인다.
- [ ] 일괄 삭제 완료 시 deletedCount가 반환되고 목록이 갱신된다.
- [ ] 복구 완료 시 restoredCount가 반환되고 목록이 갱신된다.
- [ ] 테이블 행에 호버 시 하이라이트 효과가 적용된다.
- [ ] 작업 완료/실패 시 토스트 메시지가 표시된다.

### 인수 조건 - 졸업 처리 (로드맵 1단계)
- [ ] 학생 목록에서 체크박스로 여러 학생을 선택할 수 있다.
- [ ] 1명 이상 선택 시 "N명 졸업 처리" 버튼이 활성화된다.
- [ ] 졸업 처리 버튼 클릭 시 확인 모달이 표시된다.
- [ ] 확인 모달에 선택된 학생 목록이 표시된다.
- [ ] 졸업 처리 완료 시 `graduatedCount`와 `students` 배열이 반환된다.
- [ ] 졸업 처리된 학생은 기본 목록(재학생)에서 사라진다.
- [ ] 필터에서 "재학생", "졸업생", "전체" 옵션을 선택할 수 있다.
- [ ] 기본값은 "재학생"이다 (`graduated: false`).
- [ ] "졸업생" 필터 선택 시 졸업생만 표시된다 (`graduated: true`).
- [ ] "전체" 필터 선택 시 재학생과 졸업생 모두 표시된다.
- [ ] 졸업생 필터에서 학생을 선택하여 졸업 취소할 수 있다.
- [ ] 졸업 취소 완료 시 `cancelledCount`와 `students` 배열이 반환된다.
- [ ] 졸업 취소된 학생은 재학생 목록에 복귀한다.
- [ ] 졸업 처리 시 학생 데이터가 삭제되지 않고 `graduatedAt` 필드만 설정된다.
- [ ] 졸업생의 출석 기록이 보존되어 조회 가능하다.
- [ ] 기존 `student.graduate` API 호출이 `student.promote`로 변경된다.

## 관련 문서

- Task: `docs/specs/current/functional/tasks/student-management.md`
- Development: `docs/specs/current/functional/development/student-management.md`

---

**작성일**: 2026-01-05
**최종 수정**: 2026-01-22
**상태**: Approved (기본 + 로드맵 1단계)
