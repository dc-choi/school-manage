---
paths:
  - "docs/specs/**"
---

# SDD (Spec-Driven Development) Rules

PRD, 기능 설계, Task/Development 문서 작성 규칙입니다.

## 역할 구조

| 역할             | 담당                      | 책임                              |
|----------------|-------------------------|---------------------------------|
| **사업 에이전트**    | Conductor 워크스페이스 (별도)   | 문제 정의, 가치, 우선순위, 로드맵            |
| **SDD 에이전트**   | Conductor 워크스페이스 (메인)   | 문서 작성 + 구현 + 자동 검증 + PR 생성      |
| **사용자 (검수자)**  | Conductor diff 리뷰       | PR 리뷰 → 머지 결정                   |

## 워크플로우 (7단계)

| 단계 | 담당       | 설명                           |
|----|----------|------------------------------|
| 0  | SDD 에이전트 | 작업 선택 → 사업 문서/현 상태 확인 → README.md 등록 |
| 1  | SDD 에이전트 | PRD 작성                       |
| 2  | SDD 에이전트 | 기능 설계 작성                     |
| 3  | SDD 에이전트 | Task (역할별) 작성                |
| 4  | SDD 에이전트 | Development (역할별) 작성         |
| 5  | SDD 에이전트 | 구현 + 테스트                     |
| 6  | SDD 에이전트 | 자동 검증 + 문서 정리 + PR 생성       |

## 검증 체계

검수자 세션 대신 **자동 검증 + 사용자 PR 리뷰**로 품질을 보장합니다.

- **자동 검증**: lint, typecheck, build, test, 서브에이전트 (security, design, performance)
- **사용자 리뷰**: Conductor diff 뷰에서 PR 리뷰 → 머지 결정
- **자기 검증**: 각 단계별 체크리스트로 문서 품질 확인

## 문서 구조

```
docs/specs/
├── prd/                  # PRD 문서
├── functional-design/    # 기능 설계 문서
├── current/              # 완료된 기능 명세 (SSoT)
│   └── functional/
│       ├── tasks/
│       └── development/
├── target/               # 개선/이행 예정 명세
│   ├── functional/
│   │   ├── tasks/
│   │   └── development/
│   └── non-functional/   # 완료 후 삭제됨
└── templates/            # 문서 템플릿
```

## 문서 간 계층 구조

```
PRD (무엇을 왜 만드는가)
  ↓
기능 설계 (어떻게 동작하는가)
  ↓
Task (누가 무엇을 하는가 - 역할별 업무 분할)
  ↓
Development (어떻게 구현하는가 - 역할별 구현 명세)
  ↓
구현 (코드 작성)
```

## 역할별 분할

### Task (역할별 업무 분할)

| 역할        | 접두사         | 검증 기준                 |
|-----------|-------------|-----------------------|
| 백엔드 개발자   | B1, B2, ... | `api.md`              |
| 프론트엔드 개발자 | F1, F2, ... | `web.md`, `design.md` |
| 디자이너      | D1, D2, ... | `design.md`           |

### Development (역할별 문서)

```
development/
├── {name}-backend.md      # 백엔드 구현 명세
├── {name}-frontend.md     # 프론트엔드 구현 명세
└── {name}-design.md       # 디자인 명세 (해당 시)
```

## 문서 유형별 핵심 내용

| 문서          | 질문          | 핵심 내용                              |
|-------------|-------------|------------------------------------|
| PRD         | 왜 만드는가?     | 배경, 목표, 범위, 요구사항 (Must/Should/Out) |
| 기능 설계       | 어떻게 동작하는가?  | 사용자 플로우, UI/UX, 데이터 모델, API        |
| Task        | 누가 무엇을 하는가? | 역할별 업무 분할, 의존성                     |
| Development | 어떻게 구현하는가?  | 역할별 구현 명세, 테스트 시나리오                |

## 기능 개선 시 병합 규칙

1. **별도 문서 생성 금지**: 파생 문서 X
2. **기존 문서에 병합**: 도메인별 메인 문서에 통합
3. **병합 표기**: 섹션 제목에 "(로드맵 N단계)" 등 출처 명시

## 기능 설계 문서 상세 수준

기능 설계는 **"어떻게 동작하는가"(동작 명세)** 수준만 기술합니다. 구현 상세는 Development 문서 또는 코드(SSoT)에 위임합니다.

| 유지 (동작 명세)           | 삭제 (구현 상세 → Development/코드)   |
|-----------------------|--------------------------------|
| API 필드 목록 (이름, 타입, 필수) | JSON 요청/응답 전문 예시              |
| 알고리즘 요약 (1줄)          | 의사코드 블록                       |
| 레이아웃 개념도 (ASCII 1개)   | CSS `@keyframes`, Tailwind 클래스 |
| 상태 전이 다이어그램           | TypeScript 인터페이스, 마이그레이션 SQL  |
| 테스트 시나리오 (정상/예외 핵심만)  | 파일 구조 목록, 중복 와이어프레임           |

## 6단계 문서 동기화 시 축약 규칙

6단계에서 개선 사항을 기존 기능 설계에 병합할 때, **구현 상세를 삭제하고 동작 명세 수준으로 축약**합니다.

1. **구현 상세 삭제**: JSON 전문, 의사코드, CSS 코드, Tailwind 클래스 등 제거
2. **대체된 섹션 통합**: 이전 기능을 대체하는 개선은 별도 섹션이 아닌 기존 섹션에 통합
3. **와이어프레임 정리**: 중복/중간 단계 와이어프레임 제거, 최종 개념도 1개만 유지

### 도메인별 메인 문서

| 도메인   | 문서명                        |
|-------|----------------------------|
| 출석    | `attendance-management.md` |
| 학생    | `student-management.md`    |
| 그룹    | `group-management.md`      |
| 통계    | `statistics.md`            |
| 인증/계정 | `auth-account.md`          |

## 예외 처리

| 상황      | 처리                        |
|---------|---------------------------|
| 소규모 변경  | Task/Development 없이 바로 구현 |
| UI만 변경  | Frontend Development만 작성  |
| API만 변경 | Backend Development만 작성   |

## 비기능적 요구사항 (Non-Functional)

비기능적 요구사항은 **간소화된 워크플로우**를 따릅니다.

### 간소화 이유

- 완료 후에는 **코드베이스 자체가 SSoT**
- Task/Development 문서 유지 시 코드와 불일치 발생
- 아키텍처/인프라 변경은 코드와 CLAUDE.md로 추적

### 워크플로우

```
기능 설계 → 바로 구현 → 자동 검증 + 문서 갱신 → PR 생성
```

| 단계 | 담당       | 설명                              |
|----|----------|---------------------------------|
| 1  | SDD 에이전트 | 기능 설계 작성                        |
| 2  | SDD 에이전트 | **바로 구현** (Task/Development 생략) |
| 3  | SDD 에이전트 | 자동 검증 + CLAUDE.md, README.md 갱신 |
| 4  | SDD 에이전트 | PR 생성                           |

### 문서 갱신 대상

| 변경 내용    | 갱신 대상          |
|----------|----------------|
| API 아키텍처 | `rules/api.md` |
| 웹 앱 구조   | `rules/web.md` |
| 환경변수/명령어 | `CLAUDE.md`    |

## 관련 문서

- 상세 워크플로우: `docs/specs/WORKFLOW.md`
- 템플릿: `docs/specs/templates/`
