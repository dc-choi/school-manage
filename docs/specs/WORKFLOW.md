# SDD Workflow (Claude Code)

이 문서는 SDD 실행을 위한 **역할 분리 워크플로우**를 정의합니다.

## 4개 세션 구조

```
[사업 에이전트]     [PM 에이전트]        [SDD 작성자]       [SDD 검수자]
 Claude Code   →   Claude Code    →   Claude Code   ↔   Claude Code
  (세션 1)          (세션 2)           (세션 3)          (세션 4)
docs/business/    PRD + 기능 설계      Feature/Task/      검수 + 승인
                       ↓             Development + 구현
                  [검수자 검수]
```

> **Note**: PM 에이전트 산출물(PRD, 기능 설계)도 검수자 검수를 거쳐야 SDD 작성자에게 전달됩니다.

## 역할 분담

| 세션 | 역할          | 도구          | 책임                            | 산출물 위치                                             |
|----|-------------|-------------|-------------------------------|----------------------------------------------------|
| 1  | **사업 에이전트** | Claude Code | 문제 정의, 가치, 우선순위, 로드맵          | `docs/business/`                                   |
| 2  | **PM 에이전트** | Claude Code | PRD, 기능 설계                    | `docs/specs/prd/`, `docs/specs/functional-design/` |
| 3  | **SDD 작성자** | Claude Code | Feature/Task/Development + 구현 | `docs/specs/target/` → `apps/`                     |
| 4  | **SDD 검수자** | Claude Code | 각 단계별 검수 + 최종 승인              | `docs/specs/`                                      |

| 역할            | 담당자                | 세션 | 책임                |
|---------------|--------------------|----|-------------------|
| **사용자 (조율자)** | 개발자                | -  | 에이전트 간 핸드오프 조율    |
| **사업 에이전트**   | Claude Code (세션 1) | 별도 | 문제 정의 + 가치 + 우선순위 |
| **PM 에이전트**   | Claude Code (세션 2) | 별도 | PRD + 기능 설계       |
| **SDD 작성자**   | Claude Code (세션 3) | 별도 | 문서 작성 + 구현 + 테스트  |
| **SDD 검수자**   | Claude Code (세션 4) | 별도 | 각 단계별 검수 + 최종 승인  |

> **Note**: 각 에이전트는 서로 다른 세션에서 진행하여 독립성을 유지한다.

## 핸드오프 포인트

| 핸드오프              | 트리거            | 전달 내용                              |
|-------------------|----------------|------------------------------------|
| **사업 → PM**       | 문제 정의 완료       | 문제 식별, 가치, 우선순위 (`docs/business/`) |
| **PM → 검수자**      | PRD 작성 완료      | PRD 문서 경로, 검수 요청                   |
| **검수자 → PM**      | PRD 수정 필요 시    | PRD 수정 요청 사항                       |
| **PM → 검수자**      | 기능 설계 작성 완료   | 기능 설계 문서 경로, 검수 요청                |
| **검수자 → PM**      | 기능 설계 수정 필요 시 | 기능 설계 수정 요청 사항                    |
| **PM → SDD 작성자**  | PRD + 기능 설계 승인 | PRD, 기능 설계 문서 경로 (Approved)        |
| **SDD 작성자 → 검수자** | 각 단계 완료        | Feature/Task/Development/구현 결과     |
| **SDD 검수자 → 작성자** | 수정 필요 시        | 수정 요청 사항                           |

## 전체 워크플로우 (12단계)

### Phase 1: 사업/PM (사전 단계)

| 단계   | 담당                    | 설명                                         |
|------|-----------------------|--------------------------------------------|
| B1   | 사업 에이전트 (Claude Code)       | 문제 정의 → `docs/business/` 등록                |
| B2   | 사업 에이전트 (Claude Code)       | 가치/우선순위/로드맵 정의                             |
| P1   | PM 에이전트 (Claude Code) | PRD 작성 → `docs/specs/prd/`                 |
| P1-R | 검수자 (Claude Code)     | PRD 검수 → 승인/수정 요청                          |
| P2   | PM 에이전트 (Claude Code) | 기능 설계 작성 → `docs/specs/functional-design/` |
| P2-R | 검수자 (Claude Code)     | 기능 설계 검수 → 승인/수정 요청                        |

### Phase 2: SDD (9단계: 0~8)

| 단계 | 담당            | 설명                       |
|----|---------------|--------------------------|
| 0  | 사용자 (작성자 서포트) | 작업 선택 → README.md 등록     |
| 1  | 사용자 (작성자 서포트) | PRD/기능 설계 기반 범위 확정       |
| 2  | 작성자 → 검수자     | Feature 작성 → 검수          |
| 3  | 작성자 → 검수자     | Task 작성 → 검수             |
| 4  | 작성자 → 검수자     | Development 작성 → 검수      |
| 5  | 작성자           | 구현 + 테스트                 |
| 6  | 검수자           | 정적 분석/최종 리뷰              |
| 7  | 검수자           | 문서 이동 (target → current) |
| 8  | 검수자           | 프로젝트 현황 동기화              |

> **Note**: 사업/PM 단계(B1~P2)가 선행되지 않은 경우, SDD 0단계에서 직접 문제 정의 가능

---

## B1~B2 단계: 사업 에이전트 (Claude Code)

**담당**: 사업 에이전트 (Claude Code)
**산출물**: `docs/business/`

### B1: 문제 정의

1. **문제 식별**: 사용자/비즈니스 관점에서 해결할 문제 정의
2. **가치 평가**: 문제 해결 시 기대 효과
3. **우선순위 결정**: P0/P1/P2 기준으로 평가

### B2: 로드맵/지표 정의

1. **로드맵 배치**: 어느 마일스톤에 배치할지 결정
2. **성공 지표**: 측정 가능한 목표 정의

**핸드오프 체크리스트 (사업 → PM):**
- [ ] 문제가 명확히 정의되었는가?
- [ ] 가치/우선순위가 평가되었는가?
- [ ] `docs/business/`에 문서화되었는가?

---

## P1~P2 단계: PM 에이전트 (Claude Code)

**담당**: PM 에이전트 (Claude Code)
**산출물**: `docs/specs/prd/`, `docs/specs/functional-design/`

### P1: PRD 작성

1. **배경 연결**: `docs/business/` 문서 참조
2. **PRD 작성**: 목표, 범위, 사용자 시나리오, 요구사항 정의
3. **템플릿**: `docs/specs/CLAUDE.md`의 PRD 템플릿 사용
4. **상태**: Draft → 검수자에게 전달

### P1-R: PRD 검수

**담당**: 검수자 (Claude Code)

**흐름**: PRD 검수 요청 → 검수자 검수 → 승인/수정 요청

**검수 체크리스트:**
- [ ] 문제/배경이 `docs/business/`의 문제 정의와 정합적인가?
- [ ] 목표/성공 기준이 명확하고 측정 가능한가?
- [ ] 범위(포함/제외)가 명시되어 있는가?
- [ ] 사용자 시나리오가 구체적인가?
- [ ] 요구사항이 Must/Should/Out으로 구분되어 있는가?
- [ ] 제약/가정/리스크가 식별되어 있는가?

**결과:**
- **승인**: PRD 상태 → Approved, P2 진행
- **수정 필요**: PM에게 수정 요청, P1 반복

### P2: 기능 설계 작성

1. **기능 설계 작성**: 흐름, UI/UX, 데이터 모델, API 정의
2. **SDD 연결**: Feature/Task/Development 연결 문서 명시
3. **템플릿**: `docs/specs/CLAUDE.md`의 기능 설계 템플릿 사용
4. **상태**: Draft → 검수자에게 전달

### P2-R: 기능 설계 검수

**담당**: 검수자 (Claude Code)

**흐름**: 기능 설계 검수 요청 → 검수자 검수 → 승인/수정 요청

**검수 체크리스트:**
- [ ] PRD의 요구사항이 기능 설계에 반영되어 있는가?
- [ ] 사용자 흐름/상태 전이가 명확한가?
- [ ] 데이터 모델/스키마 변경이 정의되어 있는가?
- [ ] API/인터페이스가 구체적으로 정의되어 있는가?
- [ ] 예외/엣지 케이스가 처리되어 있는가?
- [ ] 테스트 시나리오가 포함되어 있는가?

**결과:**
- **승인**: 기능 설계 상태 → Approved, SDD 작성자에게 전달
- **수정 필요**: PM에게 수정 요청, P2 반복

**핸드오프 체크리스트 (PM → SDD):**
- [ ] PRD가 `docs/specs/prd/`에 작성되고 **Approved** 상태인가?
- [ ] 기능 설계가 `docs/specs/functional-design/`에 작성되고 **Approved** 상태인가?
- [ ] 요구사항이 Must/Should/Out으로 구분되었는가?
- [ ] SDD 문서 경로가 명시되었는가?

---

## 0단계: 작업 선택

**담당**: 사용자 (조율자)
**서포트**: 작성자 (코드베이스 분석, 문제 식별, 우선순위 제안)

PRD/기능 설계가 있는 경우 해당 문서를 기반으로, 없는 경우 직접 문제를 정의한다:

1. **문제 식별**: 코드베이스, 아키텍처, 성능 등에서 개선이 필요한 부분 파악
2. **중요도 평가**: P0/P1/P2 우선순위 결정
   - **P0**: 즉시 필요 (블로커, 보안 이슈, 심각한 버그)
   - **P1**: 중요 (다음 마일스톤 내 해결)
   - **P2**: 개선 (여유 있을 때)
3. **분류 결정**: functional / non-functional 분류
4. **README.md 등록**: `docs/specs/README.md`의 TARGET 섹션에 항목 추가

**등록 형식:**
```markdown
- P{N} - {문제명}
  - Feature: `docs/specs/target/{functional|non-functional}/features/{문제명}.md`
  - Task: `docs/specs/target/{functional|non-functional}/tasks/{문제명}.md`
  - Development: `docs/specs/target/{functional|non-functional}/development/{문제명}.md`
```

**체크리스트:**
- [ ] 문제가 구체적으로 정의되었는가?
- [ ] 현재 상태와 목표 상태가 명확한가?
- [ ] 영향 범위가 파악되었는가?
- [ ] 적절한 우선순위가 부여되었는가?
- [ ] 적절한 분류(functional/non-functional)가 지정되었는가?
- [ ] PRD/기능 설계가 있다면 연결되었는가?

---

## 1단계: 범위 확정

**담당**: 사용자 (조율자)
**서포트**: 작성자 (작업 범위 분석, 의존성 파악, 구현 난이도 평가)

PRD/기능 설계 문서가 있는 경우 해당 문서를 기반으로 범위를 확정한다.

**선택 기준:**
1. **우선순위**: P0 → P1 → P2 순서로 처리
2. **의존성**: 선행 작업이 완료된 항목 우선
3. **영향도**: 다른 작업의 블로커가 되는 항목 우선

**체크리스트:**
- [ ] PRD/기능 설계 문서를 검토했는가?
- [ ] 선택한 작업의 의존성이 충족되었는가?
- [ ] 작업 범위가 명확한가?
- [ ] 예상 영향 범위를 파악했는가?

---

## 2단계: Feature 작성

**담당**: 작성자 → 검수자

**흐름**: Feature 작성 (Draft) → 검수자 검수 → 승인 (Approved)

**핸드오프 체크리스트:**
- 상위 문서(PRD/기능 설계) 링크가 있다
- PRD의 Must Have 요구사항이 기능 요구사항에 포함되어 있다
- 기능 설계의 사용자 흐름이 사용자 스토리에 반영되어 있다
- 사용자 스토리/요구사항/인수 조건이 명확하다
- 엣지 케이스가 정의되어 있다
- 관련 Task/Development 링크가 있다

**검수자 검증 포인트:**
> PRD/기능 설계를 기준으로 Feature가 요구사항을 빠짐없이 정의했는지 확인

---

## 3단계: Task 작성

**담당**: 작성자 → 검수자

**흐름**: Task 작성 (Draft) → 검수자 검수 → 승인 (Approved)

**핸드오프 체크리스트:**
- 상위 문서(PRD/기능 설계/Feature) 링크가 있다
- Feature의 기능 요구사항이 "업무 분할"에 반영되어 있다
- 업무 간 의존성과 순서가 명시되어 있다
- 범위(포함/제외)가 분명하다
- 유스케이스/엣지 케이스가 있다
- Feature의 인수 조건이 "검증 체크리스트"에 반영되어 있다

**검수자 검증 포인트:**
> Feature의 요구사항이 업무 분할에 빠짐없이 반영되었는지, 업무 순서/의존성이 적절한지 확인

---

## 4단계: Development 작성

**담당**: 작성자 → 검수자

**흐름**: Development 작성 (Draft) → 검수자 검수 → 승인 (Approved)

**핸드오프 체크리스트:**
- 상위 문서(PRD/기능 설계/Feature/Task) 링크가 있다
- Task의 "업무 분할"과 대응되는 구현 범위가 명시되어 있다
- 기능 설계의 API/데이터 모델이 정확히 반영되어 있다
- 입력/출력/상태 변경이 정의되어 있다
- 비즈니스 로직/검증/에러 처리/테스트 시나리오가 있다
- 구현 대상 파일/패턴이 명시되어 있다

**검수자 검증 포인트:**
> Task의 업무 분할대로 구현 명세가 작성되었는지, 기능 설계의 인터페이스와 일치하는지 확인

---

## 5단계: 구현 + 테스트

**담당**: 작성자

**핸드오프 체크리스트:**
- Development 문서와 구현이 정합하다
- 테스트 코드가 추가/갱신되었다
- 테스트 실행 결과가 기록된다(실행 못했다면 이유 명시)

---

## 6단계: 정적 분석/최종 리뷰

**담당**: 검수자

**흐름:**
- 승인 → 상태: Approved
- 수정 필요 → 작성자 수정 → 6단계 반복

**핸드오프 체크리스트:**
- 기능/보안/회귀 리스크를 점검한다
- 누락된 테스트/문서 갱신을 지적한다
- 승인/보완 필요 여부를 명확히 한다

---

## 7단계: 문서 이동

**담당**: 검수자

모든 문서 Approved 후 `target/` → `current/` 이동

> **Note**: 비기능적 요구사항(non-functional)은 이동하지 않고 삭제한다. 상세 내용은 "비기능적 요구사항 처리 방식" 섹션 참조.

**이동 명령 예시:**
```bash
# 기능적 요구사항 완료 시
mv docs/specs/target/functional/features/{name}.md docs/specs/current/functional/features/
mv docs/specs/target/functional/tasks/{name}.md docs/specs/current/functional/tasks/
mv docs/specs/target/functional/development/{name}.md docs/specs/current/functional/development/
mv docs/specs/target/functional/reviews/{date}-{name}-review.md docs/specs/current/functional/reviews/
```

---

## 8단계: 프로젝트 현황 동기화

**담당**: 검수자

작업 완료 후 **프로젝트 전체 문서를 현재 구현 상태와 동기화**한다.
단순히 이번 작업의 영향만 반영하는 것이 아니라, 프로젝트 전반의 문서가 실제 코드베이스와 일치하는지 검증한다.

**동기화 절차:**
1. **프로젝트 분석**: 코드베이스, 패키지 구조, 구현 현황 파악
2. **문서 비교**: 기존 문서와 실제 상태의 불일치 식별
3. **문서 갱신**: 불일치 항목 수정

**동기화 대상 문서:**

| 문서                        | 동기화 항목                    |
|---------------------------|---------------------------|
| `README.md`               | 기술 스택, 프로젝트 구조, 구현 현황 테이블 |
| `docs/specs/README.md`    | TARGET/CURRENT 인덱스        |
| `CLAUDE.md` (루트)          | 모노레포 구조, 패키지 의존성, 명령어     |
| `apps/api/CLAUDE.md`      | API 아키텍처, DB, 로깅 정책, 테스팅  |
| `apps/web/CLAUDE.md`      | 웹 앱 구조 (구현 시)             |
| `packages/trpc/CLAUDE.md` | tRPC 라우터, 타입 정의           |

**체크리스트:**
- [ ] README.md의 기술 스택이 실제와 일치하는가? (예: Sequelize → Prisma)
- [ ] README.md의 프로젝트 구조가 실제와 일치하는가?
- [ ] README.md에 구현 현황 테이블이 최신 상태인가?
- [ ] 각 CLAUDE.md가 해당 패키지의 실제 구조를 반영하는가?
- [ ] docs/specs/README.md의 TARGET/CURRENT가 최신 상태인가?
- [ ] 새로운 패턴/정책이 문서화되었는가? (예: 로깅 정책)

---

## Spec-anchored: 코드-문서 동기화

Spec-anchored 레벨에서는 코드와 문서의 양방향 동기화가 필수입니다.

### 동기화 트리거

| 트리거 | 동기화 방향 | 담당 |
|--------|------------|------|
| 새 기능 구현 | 문서 → 코드 | 작성자 |
| 기존 기능 개선 | 문서(병합) → 코드 | 작성자 |
| 코드 변경 후 문서 불일치 | 코드 → 문서 | 검수자 |
| 검수 중 누락 발견 | 문서 보완 | 검수자 |

### 기능 개선 시 문서 병합 절차

기존 기능에 개선 사항을 추가할 때는 **별도 문서를 생성하지 않고 기존 문서에 병합**합니다.

> **중요**: 이 규칙은 **기능 설계 문서와 SDD 문서(Feature/Task/Development) 모두에 적용**됩니다.

**병합 대상 문서:**

| 문서 유형 | 위치 | 병합 규칙 |
|---------|-----|---------|
| **기능 설계** | `docs/specs/functional-design/` | 도메인별 메인 문서에 병합 |
| **Feature** | `docs/specs/{target\|current}/functional/features/` | 도메인별 메인 문서에 병합 |
| **Task** | `docs/specs/{target\|current}/functional/tasks/` | 도메인별 메인 문서에 병합 |
| **Development** | `docs/specs/{target\|current}/functional/development/` | 도메인별 메인 문서에 병합 |

**도메인별 메인 문서:**

| 도메인 | 기능 설계 메인 문서 | SDD 메인 문서 |
|-------|-----------------|-------------|
| 출석 | `attendance-management.md` | `attendance-management.md` |
| 학생 | `student-management.md` | `student-management.md` |
| 그룹 | `group-management.md` | `group-management.md` |
| 통계 | `statistics.md` | `statistics.md` |
| 인증/계정 | `auth-account.md` | `auth-account.md` |

**절차:**
1. 기존 기능 설계/Feature/Task/Development 문서 확인
2. 개선 내용을 해당 문서의 새 섹션으로 추가
3. 섹션 제목에 출처 명시 (예: "### 달력 UI (로드맵 1단계)")
4. PRD의 체크리스트 갱신
5. README.md 인덱스 갱신 (비고 컬럼에 병합 표기)

**병합 시 주의사항:**
- 기존 내용 삭제/수정 시 변경 이력 남기기
- 업무 분할(Task) 넘버링 유지 (A1~A3 + B1~B7 형태)
- 유스케이스 넘버링 연속 유지 (UC-1~UC-3 + UC-4~UC-7)
- 기능 설계 문서도 동일한 넘버링/섹션 규칙 적용

**잘못된 예시 (별도 문서 생성):**
```
docs/specs/functional-design/
├── attendance-management.md      # 메인
├── attendance-auto-save.md       # ❌ 파생 문서
└── attendance-calendar-ui.md     # ❌ 파생 문서
```

**올바른 예시 (메인 문서에 병합):**
```
docs/specs/functional-design/
└── attendance-management.md      # 메인 (자동 저장, 달력 UI 섹션 포함)
    ├── ## 기본 출석 관리
    ├── ## 달력 UI (로드맵 1단계)
    └── ## 자동 저장 (로드맵 1단계)
```

### 검수자의 문서 동기화 책임

검수자는 6~8단계에서 다음을 확인합니다:

**6단계 (정적 분석):**
- [ ] 구현이 Development 문서와 일치하는가?
- [ ] 코드에만 있고 문서에 없는 로직이 있는가?
- [ ] 문서에만 있고 코드에 없는 요구사항이 있는가?

**7단계 (문서 이동):**
- [ ] 기능 설계 문서가 도메인별 메인 문서에 병합되었는가?
- [ ] SDD 문서(Feature/Task/Development)가 도메인별 메인 문서에 병합되었는가?
- [ ] 파생 문서가 삭제되었는가?
- [ ] 경로 참조가 모두 current/로 업데이트되었는가?

**8단계 (현황 동기화):**
- [ ] PRD 체크리스트가 구현 상태와 일치하는가?
- [ ] 기능 설계의 상태가 "Approved (구현 완료)"로 갱신되었는가?
- [ ] 기능 설계의 SDD 경로가 current/로 갱신되었는가?
- [ ] Feature/Task/Development 상위 문서 참조에 기능 설계가 추가되었는가?
- [ ] README.md 인덱스에 병합 비고가 추가되었는가?

### 전체 문서 체인 동기화

Spec-anchored에서는 **SDD 문서뿐만 아니라 PRD와 기능 설계도 함께 동기화**합니다.

**기능 구현 완료 시 검수자 체크리스트:**

```
1. PRD
   - [ ] 로드맵 체크리스트 갱신 (`- [ ]` → `- [x]`)

2. 기능 설계
   - [ ] 도메인별 메인 문서에 병합되었는가?
   - [ ] 파생 문서가 삭제되었는가?
   - [ ] 상태 갱신 (`Draft` → `Approved (구현 완료)`)
   - [ ] SDD 경로 갱신 (`TARGET SDD` → `CURRENT SDD`)

3. Feature/Task/Development
   - [ ] 도메인별 메인 문서에 병합되었는가?
   - [ ] 파생 문서가 삭제되었는가?
   - [ ] 상위 문서 참조에 기능 설계 추가

4. README.md
   - [ ] 인덱스 테이블 갱신
   - [ ] 비고 컬럼에 병합 표기
```

### 추적성 검증 체크리스트

Spec-anchored에서는 다음 체인의 일관성을 검증합니다:

```
PRD (Must Have)
    ↓ [추적]
기능 설계 (사용자 흐름, API)
    ↓ [추적]
Feature (사용자 스토리, 기능 요구사항, 인수 조건)
    ↓ [추적]
Task (업무 분할, 유스케이스)
    ↓ [추적]
Development (구현 명세, 테스트 시나리오)
    ↓ [추적]
코드 (실제 구현)
```

**추적성 검증 항목:**
- [ ] PRD Must Have → Feature 기능 요구사항 (1:1 매핑)
- [ ] Feature 인수 조건 → Task 검증 체크리스트 (포함)
- [ ] 기능 설계 API → Development 데이터 모델 (일치)
- [ ] Development 테스트 시나리오 → 테스트 코드 (구현)

---

## 문서 분류 기준

| 분류                 | 설명                     | 예시                     |
|--------------------|------------------------|------------------------|
| **functional**     | 사용자가 직접 사용하는 비즈니스 기능   | 로그인, 출석 관리, 통계 조회      |
| **non-functional** | 아키텍처, 성능, 보안, 유지보수성 관련 | 에러 처리, 모노레포 구성, 타입 안정성 |

---

## 비기능적 요구사항 처리 방식

비기능적 요구사항(non-functional)은 기능적 요구사항과 달리 **SSoT로 유지하지 않는다**.

### 이유

- 비기능적 요구사항은 아키텍처, 코드 품질, 성능 등의 개선 작업이다
- 완료 후에는 코드베이스 자체가 SSoT 역할을 한다
- 별도 문서로 유지하면 코드와 문서 간 불일치가 발생할 수 있다

### 처리 절차

1. **2~5단계**: 기능적 요구사항과 동일하게 진행
2. **6단계**: 정적 분석 수행, **리뷰 문서는 생성하지 않음**
3. **7단계**: `target/` 문서를 **삭제** (current로 이동하지 않음)
4. **8단계**: 관련 CLAUDE.md, README.md 등에 변경 사항 반영

### 삭제 명령 예시

```bash
# 비기능적 요구사항 완료 시
rm docs/specs/target/non-functional/features/{name}.md
rm docs/specs/target/non-functional/tasks/{name}.md
rm docs/specs/target/non-functional/development/{name}.md
```

### 8단계 문서 갱신 예시

| 변경 내용 | 갱신 대상 |
|----------|----------|
| API 아키텍처 변경 | `apps/api/CLAUDE.md` |
| tRPC 패턴 변경 | `packages/trpc/CLAUDE.md` |
| 빌드/명령어 변경 | `CLAUDE.md` (루트) |
| 기술 스택 변경 | `README.md` |

---

## 상태 규칙

| 상태           | 의미              |
|--------------|-----------------|
| **Draft**    | 작성 초기 상태        |
| **Review**   | 핸드오프 완료, 검토 진행  |
| **Approved** | 구현/테스트/정적 분석 완료 |

**상태 갱신 주체:**

| 문서/산출물      | Draft → Review | Review → Approved |
|-------------|----------------|-------------------|
| Feature     | 작성자            | 검수자               |
| Task        | 작성자            | 검수자               |
| Development | 작성자            | 검수자               |
| 구현 코드       | 작성자            | 검수자               |

---

## 예외 처리

- **소규모 버그 수정**: Feature/Task 없이 바로 Development 또는 구현 가능
- **긴급 대응**: 구현 후 Feature/Task 문서를 보강

---

## 부록: 검수 리뷰 템플릿

> 검수자는 **PRD/기능 설계 문서를 기준**으로 각 산출물이 요구사항을 충족하는지 검증합니다.
> 상세 템플릿은 `docs/specs/templates/review.md` 참조.

### PRD 검수 리뷰

```markdown
## PRD 검수 결과

**문서**: [PRD 경로]
**결과**: 승인 / 수정 필요

### 참조 문서
- 사업 문서: [docs/business/ 경로]

### 내용 검수 체크리스트
- [ ] 문제/배경이 사업 문서와 정합적인가?
- [ ] 목표/성공 기준이 명확하고 측정 가능한가?
- [ ] 대상 사용자/사용 맥락이 정의되어 있는가?
- [ ] 범위(포함/제외)가 명시되어 있는가?
- [ ] 사용자 시나리오가 구체적인가?
- [ ] 요구사항이 Must/Should/Out으로 구분되어 있는가?
- [ ] 제약/가정/리스크가 식별되어 있는가?

### 수정 요청 (수정 필요 시)
| # | 섹션 | 설명 | 우선순위 |
|---|------|------|---------|
| 1 | [섹션명] | [구체적 수정 내용] | High/Medium/Low |

### 코멘트
[추가 의견]
```

### 기능 설계 검수 리뷰

```markdown
## 기능 설계 검수 결과

**문서**: [기능 설계 경로]
**결과**: 승인 / 수정 필요

### 참조 문서
- PRD: [PRD 경로]
- 사업 문서: [docs/business/ 경로]

### 내용 검수 체크리스트
- [ ] PRD의 요구사항이 기능 설계에 반영되어 있는가?
- [ ] 사용자 흐름/상태 전이가 명확한가?
- [ ] UI/UX 요소가 정의되어 있는가? (해당 시)
- [ ] 데이터 모델/스키마 변경이 정의되어 있는가?
- [ ] API/인터페이스가 구체적으로 정의되어 있는가?
- [ ] 권한/보안 요구사항이 명시되어 있는가?
- [ ] 예외/엣지 케이스가 처리되어 있는가?
- [ ] 테스트 시나리오가 포함되어 있는가?

### 수정 요청 (수정 필요 시)
| # | 섹션 | 설명 | 우선순위 |
|---|------|------|---------|
| 1 | [섹션명] | [구체적 수정 내용] | High/Medium/Low |

### 코멘트
[추가 의견]
```

### Feature 검수 리뷰

```markdown
## Feature 검수 결과

**문서**: [문서 경로]
**결과**: 승인 / 수정 필요

### 참조 문서
- PRD: [PRD 경로]
- 기능 설계: [기능 설계 경로]

### 요구사항 추적 체크리스트
- [ ] PRD의 Must Have 요구사항이 모두 "기능 요구사항"에 포함되었는가?
- [ ] 기능 설계의 사용자 흐름이 "사용자 스토리"에 반영되었는가?
- [ ] 기능 설계의 예외/엣지 케이스가 "엣지 케이스"에 포함되었는가?

### 문서 품질 체크리스트
- [ ] 사용자 스토리가 명확한가?
- [ ] 인수 조건이 검증 가능한가?
- [ ] 엣지 케이스가 정의되었는가?

### 수정 요청 (수정 필요 시)
| # | 항목 | 설명 | 우선순위 |
|---|------|------|---------|
| 1 | [섹션명] | [구체적 수정 내용] | High/Medium/Low |

### 코멘트
[추가 의견]
```

### Task 검수 리뷰

```markdown
## Task 검수 결과

**문서**: [문서 경로]
**결과**: 승인 / 수정 필요

### 참조 문서
- PRD: [PRD 경로]
- 기능 설계: [기능 설계 경로]
- Feature: [Feature 경로]

### 요구사항 추적 체크리스트
- [ ] Feature의 모든 기능 요구사항이 "업무 분할"에 반영되었는가?
- [ ] 기능 설계의 API/데이터 모델 변경이 업무에 포함되었는가?
- [ ] Feature의 인수 조건이 "검증 체크리스트"에 반영되었는가?

### 업무 분할 체크리스트
- [ ] 범위(포함/제외)가 명확한가?
- [ ] 업무 간 의존성이 명시되었는가?
- [ ] 유스케이스에 구현 방향이 명시되었는가?
- [ ] 엣지 케이스 처리 방법이 구체적인가?

### 수정 요청 (수정 필요 시)
| # | 항목 | 설명 | 우선순위 |
|---|------|------|---------|
| 1 | [UC-N / 업무 #N] | [구체적 수정 내용] | High/Medium/Low |

### 코멘트
[추가 의견]
```

### Development 검수 리뷰

```markdown
## Development 검수 결과

**문서**: [문서 경로]
**결과**: 승인 / 수정 필요

### 참조 문서
- PRD: [PRD 경로]
- 기능 설계: [기능 설계 경로]
- Feature: [Feature 경로]
- Task: [Task 경로]

### 요구사항 추적 체크리스트
- [ ] Task의 "업무 분할"에 명시된 업무가 모두 구현 대상에 포함되었는가?
- [ ] 기능 설계의 API 인터페이스가 "데이터 모델"에 정확히 반영되었는가?
- [ ] 기능 설계의 권한/보안 요구사항이 "검증 규칙"에 포함되었는가?

### 구현 명세 체크리스트
- [ ] 데이터 모델(요청/응답)이 명확한가?
- [ ] 비즈니스 로직이 구체적인가?
- [ ] 검증 규칙이 정의되었는가?
- [ ] 테스트 시나리오가 충분한가?

### 수정 요청 (수정 필요 시)
| # | 항목 | 설명 | 우선순위 |
|---|------|------|---------|
| 1 | [섹션명] | [구체적 수정 내용] | High/Medium/Low |

### 코멘트
[추가 의견]
```

### 구현 검수 리뷰

```markdown
## 구현 검수 결과

**변경 파일**: [파일 목록]
**결과**: 승인 / 수정 필요

### 참조 문서
- PRD: [PRD 경로]
- 기능 설계: [기능 설계 경로]
- Feature: [Feature 경로]
- Task: [Task 경로]
- Development: [Development 경로]

### 요구사항 추적 체크리스트
- [ ] Development 문서와 구현이 일치하는가?
- [ ] PRD의 Must Have 요구사항이 모두 구현되었는가?
- [ ] 기능 설계의 API 인터페이스대로 구현되었는가?
- [ ] Feature의 인수 조건을 충족하는가?

### 구현 품질 체크리스트
- [ ] 타입 안전성이 확보되었는가?
- [ ] 빌드가 성공하는가?
- [ ] 테스트가 통과하는가? (실행 가능 시)

### 발견 사항 (수정 필요 시)
| # | 파일:라인 | 설명 | 심각도 |
|---|----------|------|--------|
| 1 | [경로:N] | [구체적 이슈] | Critical/Major/Minor |

### 코멘트
[추가 의견]
```

---

## 부록: 정적 분석 리뷰 문서 템플릿

**파일명 규칙:** `{날짜}-{대상}-review.md` (예: `20260106-error-handling-review.md`)

```markdown
# 정적 분석 리뷰: [대상 기능/모듈명]

- 분석일: YYYY-MM-DD
- 분석자: 검수자
- 상태: pending_fix / fixed / approved

## 분석 대상
- 관련 문서: [Feature/Task/Development 경로]
- 변경 파일: [파일 목록]

## 발견 사항

### Critical (즉시 수정 필요)
- [ ] [파일:라인] 설명

### Major (수정 권장)
- [ ] [파일:라인] 설명

### Minor (개선 제안)
- [ ] [파일:라인] 설명

## 테스트 커버리지
- 누락된 테스트 케이스:
  - [ ] 케이스 설명

## 보안 점검
- [ ] 입력 검증
- [ ] 인증/인가
- [ ] SQL Injection / XSS
- [ ] 민감 정보 노출

## 수정 완료 확인
<!-- 수정 후 검수자가 작성 -->
- 수정일:
- 확인자: 검수자
- 결과: approved / needs_rework
```

---

## 부록: 에이전트 간 핸드오프

### 핸드오프 메시지 템플릿

```
## 현재 작업
- 작업명: [Feature/Task/Development 파일명]
- 단계: [현재 워크플로우 단계 번호]
- 상태: [Draft/Review/Approved]

## 완료된 내용
- [구체적인 완료 항목]

## 미해결 이슈
- [blocking 이슈가 있다면 명시]

## 다음 에이전트 요청 사항
- [다음 에이전트가 해야 할 구체적 작업]

## 참조 파일
- [관련 문서/코드 경로]
```

### 작성자 → 검수자 검수 요청

**필수 전달 항목:**
1. 작성한 문서 경로
2. 작성 내용 요약
3. 검수 요청 사항
4. 알려진 이슈 (있다면)

**예시:**
```
## Feature 검수 요청

문서: docs/specs/target/non-functional/features/backend-error-handling.md
요약: 중앙 에러 처리 미들웨어 도입
- US-1: 컨트롤러 try/catch 제거
- US-2: 에러 로깅 일원화
인수조건: 5개 정의
검수요청: Feature 문서 검토 후 승인/수정 요청 부탁드립니다.
```

### 검수자 → 작성자 수정 요청

**필수 전달 항목:**
1. 검수 대상 문서 경로
2. 수정 필요 항목 (구체적으로)
3. 수정 우선순위
4. 제약 사항 (있다면)

**예시:**
```
## Feature 수정 요청

문서: docs/specs/target/non-functional/features/backend-error-handling.md
수정항목:
1. [Major] US-2에 에러 응답 포맷 명시 필요
2. [Minor] 엣지 케이스에 네트워크 타임아웃 추가
제약: HTTP 200 유지 (프론트 호환성)
```

### 작업 중단 시 맥락 보존

세션이 끊기거나 작업을 중단해야 할 때:

1. **현재 상태를 문서에 기록**
   - Development 문서의 `## 구현 상태` 섹션 갱신
   - 또는 `HANDOFF.md` 파일 생성

2. **git stash 또는 WIP 커밋**
   ```bash
   git add . && git commit -m "WIP: [작업명] - [현재 단계]"
   ```

3. **다음 세션 시작 시**
   - 이전 세션의 맥락 요약을 첫 메시지로 전달
   - 관련 문서 경로 명시
